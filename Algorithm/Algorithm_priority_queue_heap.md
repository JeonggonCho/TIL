# 우선순위 큐, 힙

## 목차

1. [우선순위 큐(Priority Queue)](#1-우선순위-큐priority-queue)
    1. [우선순위 큐 구현](#1-우선순위-큐-구현)
2. [힙(heap)](#2-힙heap)
    1. [완전 이진 트리(Complete Binary Tree)](#2-1-완전-이진-트리complete-binary-tree)
    2. [최소 힙 구성 함수: Min-Heapify()](#2-2-최소-힙-구성-함수-min-heapify)
    3. [힙에 새로운 원소 삽입할 때](#2-3-힙에-새로운-원소-삽입할-때)
    4. [힙에서 원소가 제거될 때](#2-4-힙에서-원소가-제거될-때)
    5. [파이썬의 최소 힙](#2-5-파이썬의-최소-힙)
    6. [파이썬의 최대 힙](#2-6-파이썬의-최대-힙)

<br>
<br>

## 1. 우선순위 큐(Priority Queue)

-   우선순위 큐는 `우선순위가 가장 높은 데이터`를 먼저 삭제하는 자료구조
-   데이터를 우선순위에 따라 처리해야 할 경우 사용
    -   ex) 자료구조에서 가치기 높은 물건부터 꺼내야 하는 경우

| 자료구조                    | 추출되는 데이터             |
| --------------------------- | --------------------------- |
| 스택(Stack)                 | 가장 나중에 삽입된 데이터   |
| 큐(Queue)                   | 가장 먼저 삽입된 데이터     |
| 우선순위 큐(Priority Queue) | 가장 우선순위가 높은 데이터 |

<br>

### 1-1. 우선순위 큐 구현

-   단순히 리스트(list) 자료형을 이용하여 구현
-   `힙(heap)`을 이용하여 구현

<br>

<데이터 개수 N일 경우, 시간복잡도 비교>

| 우선순위 큐 구현 방식 | 삽입 시간 | 삭제 시간 |
| --------------------- | --------- | --------- |
| 리스트                | O(1)      | O(N)      |
| 힙(heap)              | O(logN)   | O(logN)   |

-   리스트에 데이터를 삽입할 경우, 단순히 뒤에 넣으면 되기에 시간복잡도는 상수시간 O(1)
-   리스트에서 우선순위가 높은 데이터를 삭제할 경우, 우선순위가 높은 데이터를 찾아야 하기에 시간복잡도는 선형 탐색시간인 O(N)
-   반면 힙(heap)은 삽입, 삭제 모두 최악의 경우에도 시간복잡도 O(logN)을 보장
-   단순히 N개의 데이터를 `힙에 넣었다가 모두 꺼내는 작업`은 `정렬`과 동일(`힙 정렬`)
    -   이 경우, 시간복잡도는 `O(NlogN)`

<br>
<br>

## 2. 힙(heap)

-   힙은 `완전 이진 트리 자료구조`
-   힙에서는 항상 `루트 노드(root node)`를 제거

> 최소 힙(min heap)
>
> -   루트 노드가 가장 작은 값을 가짐
> -   값이 작은 데이터가 우선적으로 제거

> 최대 힙(max heap)
>
> -   루트 노드가 가장 큰 값을 가짐
> -   값이 큰 데이터가 우선적으로 제거

![최소힙_예시]()

<최소힙 예시>

<br>

### 2-1. 완전 이진 트리(Complete Binary Tree)

-   완전 이진 트리란 루트(root) 노드부터 시작하여 왼쪽 자식노드, 오른쪽 자식노드 순서대로 데이터가 차례대로 삽입되는 트리(tree)를 의미

![완전_이진_트리_예시]()

<완전 이진 트리 예시>

<br>

### 2-2. 최소 힙 구성 함수: Min-Heapify()

-   (상향식) 부모 노드로 거슬러 올라가며, 부모보다 자신의 값이 더 작은 경우에 위치를 교체

![최소힙_구성_예시]()

<최소힙 구성 예시>

<br>

### 2-3. 힙에 새로운 원소 삽입할 때

-   새로운 원소가 삽입되었을 때 `O(logN)`의 시간복잡도로 힙 성질 유지

![힙_삽입_예시]()

<힙 삽입 예시>

<br>

### 2-4. 힙에서 원소가 제거될 때

-   원소가 제거 되었을때 `O(logN)`의 시간복잡도로 힙 성질 유지
    -   원소를 제거할 때는 `가장 마지막 노드`가 `루트 노드 위치`에 오도록 함
    -   이후, 루트 노드에서 `하향식으로(더 작은 자식 노드로) Heapify()`를 진행

![힙_삭제_예시]()

<힙 삭제 예시>

<br>

### 2-5. 파이썬의 최소 힙

```bash
ex)

# 우선순위 큐 라이브러리를 활용한 힙 정렬 구현 예제 (Python)

import sys
import heapq # 파이썬의 heapq 모듈은 기본적으로 최소 힙 지원(min heap)
input = sys.stdin.readline

def heapsort(iterable):
    h = []
    result = []

    # 모든 원소를 차례대로 힙에 삽입
    for value in iterable:
        heapq.heappush(h, value)

    # 힙에 삽입된 모든 원소를 차례대로 꺼내어 담기
    for i in range(len(h)):
        result.append(heapq.heappop(h))
    return result

n = int(input())
arr = []

for i in range(n):
    arr.append(int(input()))

res = heapsort(arr)

for i in range(n):
    print(res[i])
```

-   `파이썬의 heapq` 모듈은 우선순위 큐 자료구조를 지원하며, 기본적으로 `최소 힙`의 형태로 정렬
-   heapq.heappush(heap, item) : heap에 item 추가
-   heapq.heappop(heap) : heap에서 가장 작은 값의 원소를 꺼내기, heap이 비어 있을 경우 indexError 발생
-   heapq.heapify(li) : 리스트 li를 heap으로 변환, 선형 탐색 `시간복잡도`로 `O(N)`

<br>

### 2-6. 파이썬의 최대 힙

```bash
ex)

# 최대 힙 만들기 (Python)

import heapq

heap_items = [2, 4, 3, 7, 1]

max_heap = []
for item in heap_items:
    # 값에 (-)를 붙힌 값과 원래 값을 튜플 형태로 힙에 넣어준다.
    heapq.heappush(max_heap, (-item, item))

print(max_heap)

출력
>> [(-7, 7), (-4, 4), (-3, 3), (-2, 2), (-1, 1)]

for i in range(len(heap_items)):
    print(heapq.heappop(max_heap)[1])

출력
>> 7
>> 4
>> 3
>> 2
>> 1
```

-   최대 힙에 원소를 추가할 경우, (-item, item)의 튜플 형태로 값을 넣기
-   튜플의 첫 번째 원소(인덱스 0 위치의 값)를 우선순위로 힙을 구성
-   이후 사용 시, 튜플의 두 번째 원소(인덱스 1 위치의 값)의 값을 이용
