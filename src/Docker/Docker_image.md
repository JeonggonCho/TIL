# 도커 파일로 도커 이미지 만들기

## 목차

1. [도커 이미지 생성순서](#1-도커-이미지-생성순서)
    1. [docker build <경로>](#1-1-docker-build-경로)
    2. [build 과정 설명](#1-2-build-과정-설명)
        - [임시 컨테이너](#--임시-컨테이너)
    3. [docker run <아이디>](#1-3-docker-run-아이디)

<br/>
<br/>

## 1. 도커 이미지 생성순서

```
도커 파일 --> 도커 클라이언트 --> 도커 서버 --> 이미지
```

- 도커 파일에 입력된 내용들이 도커 클라이언트에 전달되어 도커 서버가 인식하게 하여야 함

<br/>

### 1-1. docker build <경로>

- 해당 디렉토리 내에서 dockerfile이라는 파일을 찾아 도커 클라이언트에게 전달시켜줌
- 도커가 켜져있는 상태여야 함 (running)

```bash
# 현재 디렉토리에서 실행하기

$ docker build ./

# 또는

$ docker build .
```

<br/>


![도커 빌드](../assets/img/docker_build.png)

<도커 빌드 실행>

<br/>

### 1-2. build 과정 설명

- Step 1/2 : alpine 이미지 가져오기 a24bb~ 는 alpine 이미지 아이디
- Step 2/2 : 임시 컨테이너 생성 후, 그 컨테이너에 시작 시 사용할 명령어 포함시키기 그런 다음 방금 생성한 임시 컨테이너를 지우고 새로운 이미지 만들기

<br/>

### - 임시 컨테이너

- Step 2/2를 보면 임시 컨테이너를 생성하고 무언가를 하고 다시 지우는데 이유가 무엇일까?
- 베이스 이미지에서 다른 종속성이나 새로운 커맨드를 추가할 경우, 이미지에 바로 추가시키는 것이 아닌 임시 컨테이너를 만들고 임시 컨테이너를 토대로 새로운 이미지를 만듦
- 그 다음 임시 컨테이너를 지워주는 과정을 거침

<br/>

![임시 컨테이너](../assets/img/docker_intermediate_container.png)

<임시 컨테이너>

<br/>

### 1-3. docker run <아이디>

- build 이 후, 생성된 이미지 실행하기

```bash
# build 결과

writing image sha256:f59ee0a1d0...

$ docker run f59

# id 전체를 다 작성하지 않고 앞의 일부분만 작성해서 실행해도 됨

# 출력
# hello
```